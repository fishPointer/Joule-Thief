Version 4
SHEET 1 1020 680
WIRE 480 -224 -128 -224
WIRE 608 -224 480 -224
WIRE 480 -192 480 -224
WIRE 512 -192 480 -192
WIRE 608 -176 608 -224
WIRE 608 -176 576 -176
WIRE 512 -160 480 -160
WIRE 144 -64 -320 -64
WIRE 176 -64 144 -64
WIRE 368 -64 352 -64
WIRE 480 -64 480 -160
WIRE 480 -64 448 -64
WIRE 624 -64 480 -64
WIRE 752 -64 720 -64
WIRE 864 -64 832 -64
WIRE 480 -32 480 -64
WIRE 352 -16 352 -64
WIRE 480 48 480 32
WIRE 144 112 144 -64
WIRE -128 128 -128 -224
WIRE -96 128 -128 128
WIRE 112 128 -16 128
WIRE 208 144 176 144
WIRE 640 144 640 -16
WIRE 640 144 208 144
WIRE 112 160 48 160
WIRE 48 176 48 160
WIRE 48 176 -80 176
WIRE 144 192 144 176
WIRE -320 240 -320 -64
WIRE -208 240 -320 240
WIRE -80 240 -80 176
WIRE -80 240 -128 240
WIRE -32 240 -80 240
WIRE 208 240 208 144
WIRE 208 240 48 240
WIRE -320 272 -320 240
WIRE -320 384 -320 352
FLAG -320 384 0
FLAG 144 192 0
FLAG 864 -64 0
FLAG 480 48 0
FLAG 352 -16 0
FLAG 176 -64 VCC
SYMBOL Comparator\\lm393 144 144 R0
SYMATTR InstName U1
SYMBOL res 0 112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rs
SYMATTR Value 3.3k
SYMBOL res -112 224 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value {R1}
SYMBOL res 64 224 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value {R2}
SYMBOL voltage -320 256 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 5
SYMBOL res 736 -48 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R4
SYMATTR Value 100
SYMBOL pmos 720 -16 M270
SYMATTR InstName M2
SYMATTR Value AO6407
SYMBOL polcap 464 -32 R0
WINDOW 3 24 56 Left 2
SYMATTR InstName C1
SYMATTR Value 1000µ
SYMATTR Description Capacitor
SYMATTR Type cap
SYMATTR SpiceLine V=10 Irms=520m Rser=0.112 Lser=22.8n mfg="Würth Elektronik" pn="860020275015 WCAP-ATG5 10x12,5" type="Al electrolytic"
SYMBOL opamp 544 -240 R0
SYMATTR InstName U2
SYMBOL current 368 -64 R270
WINDOW 0 32 40 VTop 2
WINDOW 3 -32 40 VBottom 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName I1
SYMATTR Value 0.01
TEXT -408 408 Left 2 !.tran 2 startup
TEXT -192 360 Left 2 !.param Rp =(R1/R2)
TEXT -192 312 Left 2 !.param R1=10k
TEXT -192 336 Left 2 !.param R2=3.3k
